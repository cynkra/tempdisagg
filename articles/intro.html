<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Temporal Disaggregation of Time Series â€¢ tempdisagg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Temporal Disaggregation of Time Series">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tempdisagg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/hf-disagg.html">Temporal Disaggregation to High-Frequency</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Temporal Disaggregation of Time Series</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/christophsax/tempdisagg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Temporal Disaggregation of Time Series</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/christophsax/tempdisagg/blob/main/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<p>This is a short introduction to tempdisagg. Our article on
<strong>temporal disaggregation of time series</strong> () in the
R-Journal describes the package and the theory of temporal
disaggregation in more detail.</p>
<p>For citation, please see <code>citation("tempdisagg")</code>.</p>
<div class="section level2">
<h2 id="disaggregating-annual-data-to-quarterly">Disaggregating annual data to quarterly<a class="anchor" aria-label="anchor" href="#disaggregating-annual-data-to-quarterly"></a>
</h2>
<p>Suppose we have an annual series and want to create quarterly values
that sum up to the annual values. Let us explore the annual sales of the
pharmaceutical and chemical industry in Switzerland, from which we want
to create a quarterly series.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://journal.r-project.org/archive/2013-2/sax-steiner.pdf" class="external-link">tempdisagg</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">swisspharma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sales.a</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-2-1.png" width="681.6"></p>
</div>
<div class="section level2">
<h2 id="no-indicator">No indicator<a class="anchor" aria-label="anchor" href="#no-indicator"></a>
</h2>
<p>The most simple method is <code>denton-cholette</code> without an
indicator. It performs a simple interpolation that meets the temporal
additivity constraint. In R, this can be done the following way:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td.html">td</a></span><span class="op">(</span><span class="va">sales.a</span> <span class="op">~</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="st">"quarterly"</span>, method <span class="op">=</span> <span class="st">"denton-cholette"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/td.html">td()</a></code> produces an object of class <code>"td"</code>. The
formula, <code>'sales.a ~ 1'</code>, indicates that our low frequency
variable will be disaggregated with a constant. The resulting quarterly
values of sales can be extracted with the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<p>As there is no additional information on quarterly movements, the
resulting series is very smooth:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-4-1.png" width="681.6"></p>
</div>
<div class="section level2">
<h2 id="using-additional-information">Using additional information<a class="anchor" aria-label="anchor" href="#using-additional-information"></a>
</h2>
<p>While this purely mathematical approach is easy to perform and does
not need any other data series, the economic value of the resulting
series may be limited. There might be a related quarterly series that
follows a similar movement than sales. For example, we may use quarterly
exports of pharmaceutical and chemical products:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">exports.q</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-5-1.png" width="681.6"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td.html">td</a></span><span class="op">(</span><span class="va">sales.a</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">exports.q</span>, method <span class="op">=</span> <span class="st">"denton-cholette"</span><span class="op">)</span></span></code></pre></div>
<p>Because we cannot use more than one indicator with the
<code>denton-cholette</code> or <code>denton</code> method, the
intercept must be specified as missing in the formula
(<code>~ 0</code>). Contrary to the first example, the <code>to</code>
argument is redundant, because the destination frequency can be
interfered from the time series properties of
<code>exports.q</code>.</p>
<p>The resulting model leads to a much more interesting series:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-6-1.png" width="681.6"></p>
<p>As the indicator series is longer than the annual series, there is an
extrapolation period, in which the quarterly sales are forecasted.</p>
<p>With an indicator, the <code>denton-cholette</code> method simply
transfers the movement of the indicator to the resulting series. Even if
in fact there were no correlation between the two series, there would be
a strong similarity between the indicator and the resulting series.</p>
</div>
<div class="section level2">
<h2 id="regression-based-disaggregation">Regression based disaggregation<a class="anchor" aria-label="anchor" href="#regression-based-disaggregation"></a>
</h2>
<p>In contrast, regression based methods transfer the movement only if
the indicator series and the resulting series are actually correlated on
the annual level. For example, a Chow-Lin regression of the same problem
as above can be performed the following way:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td.html">td</a></span><span class="op">(</span><span class="va">sales.a</span> <span class="op">~</span> <span class="va">exports.q</span><span class="op">)</span></span></code></pre></div>
<p>As <code>chow-lin-maxlog</code> is the default method, it does not
need to be specified. Like with the corresponding <code>lm</code>
method, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> produces an overview of the
regression:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; td(formula = sales.a ~ exports.q)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -77.892  -7.711  -4.628   9.647  36.448 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 1.241e+01  1.493e+00   8.311 1.06e-09 ***</span></span>
<span><span class="co">#&gt; exports.q   1.339e-02  1.672e-04  80.111  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'chow-lin-maxlog' disaggregation with 'sum' conversion</span></span>
<span><span class="co">#&gt; 36 low-freq. obs. converted to 158 high-freq. obs.</span></span>
<span><span class="co">#&gt; Adjusted R-squared: 0.9946   AR1-Parameter:     0 (truncated)</span></span></code></pre></div>
<p>There is indeed a strong correlation between exports and sales, as it
has been assumed in the example above. The coefficient of
<code>exports.q</code> is highly significant, and the very high adjusted
R-squared points to a strong relationship between the two variables. The
coefficients are the result of a GLS regression between the annual
series.</p>
<p>The estimation of the AR1 parameter, <em>rho</em>, was estimated to
be negative; in order to avoid the undesirable side-effects of a
negative <em>rho</em>, it has been truncated to 0. This feature can be
turned off:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/td.html">td</a></span><span class="op">(</span><span class="va">sales.a</span> <span class="op">~</span> <span class="va">exports.q</span>, truncated.rho <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; td(formula = sales.a ~ exports.q, truncated.rho = -1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    exports.q  </span></span>
<span><span class="co">#&gt;    12.31579      0.01341  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Use summary() for details. </span></span>
<span><span class="co">#&gt; Use predict() to extract the final series.</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; Use ?td to see the help file.</span></span></code></pre></div>
<p>Again, we can extract the resulting quarterly series of sales:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-10-1.png" width="681.6"></p>
<p>Like all regression based methods, <code>chow-lin-maxlog</code> can
also be used with more than one indicator series (<code>imports.q</code>
is only significant on a 10% level in the following example, it probably
will not help to produce a more accurate temporal disaggregation):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/td.html">td</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">sales.a</span> <span class="op">~</span> <span class="va">exports.q</span> <span class="op">+</span> <span class="va">imports.q</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; td(formula = sales.a ~ exports.q + imports.q)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -61.648  -7.139  -2.825   5.508  53.373 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 11.685855   1.493077   7.827 5.08e-09 ***</span></span>
<span><span class="co">#&gt; exports.q    0.011258   0.001158   9.723 3.26e-11 ***</span></span>
<span><span class="co">#&gt; imports.q    0.003934   0.002113   1.862   0.0716 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'chow-lin-maxlog' disaggregation with 'sum' conversion</span></span>
<span><span class="co">#&gt; 36 low-freq. obs. converted to 158 high-freq. obs.</span></span>
<span><span class="co">#&gt; Adjusted R-squared: 0.9949   AR1-Parameter:     0 (truncated)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-of-methods">Comparison of methods<a class="anchor" aria-label="anchor" href="#comparison-of-methods"></a>
</h2>
<p>In our example, we actually know the true data on quarterly sales, so
we can compare the artificial values to the true values:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sales.q</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="co"># Denton-Cholette</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># Chow-Lin</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-12-1.png" width="681.6"></p>
<p>With an indicator series, both the Denton method and Chow-Lin produce
a series that is close to the true series. This is, of course, due to
fact that in this example, exports are a good indicator for sales. If
the indicator is less close to the series of interest, the resulting
series will be less close to the true series.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christoph Sax, Peter Steiner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
